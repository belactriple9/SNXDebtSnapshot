<!DOCTYPE html>
<html>

<head>
    <script type="text/json"
        src="https://cdn.jsdelivr.net/npm/@1inch/limit-order-protocol@1.3.0/abi/LimitOrderProtocol.json"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.3.6/dist/web3.min.js" type="text/javascript"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js" type="application/javascript"></script>
    <script async>

        $(() => {
            $("#submit").on('click', async (e) => {
                e.preventDefault();
                //Checking the debt on layer 2
                $("#results").append("Layer 2 debt snapshot $" + await fetch("https://api.thegraph.com/subgraphs/name/synthetixio-team/optimism-main", {
                    "referrerPolicy": "strict-origin-when-cross-origin",
                    "body": "{\"query\":\"\\n\\t\\tquery debtSnapshots($autoGeneratedPaginationField: Int, $max: Int, $account: String, $minBlock: Int, $maxBlock: Int) {\\n\\t\\t\\tdebtSnapshots(\\n\\t\\t\\t\\tfirst: $max\\n\\t\\t\\t\\twhere: { account: $account }\\n\\t\\t\\t\\torderBy: timestamp\\n\\t\\t\\t\\torderDirection: desc\\n\\t\\t\\t) {\\n        id\\n        account\\n        timestamp\\n        block\\n        collateral\\n        debtBalanceOf\\n        balanceOf\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\",\"variables\":{\"account\":\"" + $("#address")[0].value + "\",\"max\":1}}",
                    "method": "POST",
                    "mode": "cors",
                    "credentials": "omit"
                }).then(response => response.json()).then(data => data.data.debtSnapshots[0].debtBalanceOf).catch(error => console.log(error)))


                $("#results").append("\n\n");

                //Checking the debt on mainnet
                $("#results").append("Layer 1 debt snapshot " + await fetch("https://api.thegraph.com/subgraphs/name/synthetixio-team/synthetix", {
                    "referrer": "https://staking.synthetix.io/",
                    "referrerPolicy": "strict-origin-when-cross-origin",
                    "body": "{\"query\":\"\\n\\t\\tquery debtSnapshots($autoGeneratedPaginationField: Int, $max: Int, $account: String, $minBlock: Int, $maxBlock: Int) {\\n\\t\\t\\tdebtSnapshots(\\n\\t\\t\\t\\tfirst: $max\\n\\t\\t\\t\\twhere: { account: $account }\\n\\t\\t\\t\\torderBy: timestamp\\n\\t\\t\\t\\torderDirection: desc\\n\\t\\t\\t) {\\n        id\\n        account\\n        timestamp\\n        block\\n        collateral\\n        debtBalanceOf\\n        balanceOf\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\",\"variables\":{\"account\":\"" + $("#address")[0].value + "\",\"max\":1}}",
                    "method": "POST",
                    "mode": "cors",
                    "credentials": "omit"
                }).then(response => response.json()).then(data => data.data.debtSnapshots[0].debtBalanceOf).catch(error => console.log(error)))
            });
        });

    </script>

</head>

</body>


<br><br>


<form style="height:30px">
    <text>Enter an Address </text>
    <input type="text" id="address" style="width:250px;"></input>
</form>

<br>

<button id="submit" style="height:30px">Submit</button>

<br>



<h4>Results</h4>
<p id="results" style="white-space: pre-line; display: block;">

</p>



<style>

</style>

</html>